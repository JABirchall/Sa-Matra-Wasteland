/*
	ArmA 3 Wasteland
	Code written by Sa-Matra
	Using this code without Sa-Matra's direct permission is forbidden
	
	
	Special build for Dwarden
	
	ESABQIEXHTFRGOFR
*/
if(wgwa58)then{systemChat wgv8c1;}else{wgwa58=true;wgm1lv=objNull;private["_0cv","_0vv","_arme_principale","_0xv","_0yv","_0wv","_enemy_nearby"];_0cv=_this select 0;if!(_0cv call wgbqap)exitWith{_0ho=(_0cv call wgdtln);if(_0ho call wgr44t)then{hint format["This object is locked by %1 and cannot be taken",name _0ho];}else{hint "This object is locked and cannot be taken";};wgwa58=false;};if(_0cv getVariable["R3F_restore_simulation",false])then{[_0cv,true]call wgqhik;call wgm6cs;_0cv setVariable["R3F_restore_simulation",nil,true];};_0vv=_0cv getVariable "R3F_ARTY_est_calculateur";if!(isNil "_0vv")then{wgwa58=false;[_0cv]execVM "r3f\R3F_ARTY\poste_commandement\deplacer_calculateur.sqf";}else{_0ge=diag_tickTime+3;wgfg5m=[_0cv,player];publicVariableServer "wgfg5m";waitUntil{((wg8utn==_0cv)&&(local _0cv))||diag_tickTime>_0ge};if(diag_tickTime>_0ge)exitWith{systemChat "Failed to take the object";wgwa58=false;};_0cv setVariable["R3F_LOG_est_deplace_par",player,true];wgcty8=_0cv;if(!alive player)then{wgcty8=objNull;_0cv setVariable["R3F_LOG_est_deplace_par",objNull,true];_0cv setPos[getPos _0cv select 0,getPos _0cv select 1,0];_0cv setVelocity[0,0,0];wgwa58=false;}else{_0hv=0;switch(true)do{case(_0cv isKindOf "Cargo_Tower_base_F"):{_0hv=12;};case(_0cv isKindOf "Quadbike_01_base_F"):{_0hv=0.5;};};_0cv attachTo[player,[0,(((boundingBox _0cv select 1 select 1)max(-(boundingBox _0cv select 0 select 1)))max((boundingBox _0cv select 1 select 0)max(-(boundingBox _0cv select 0 select 0))))+1,1+_0hv]];if(!surfaceIsWater getPosATL(player))then{player forceWalk true;if(!weaponLowered player)then{player action["WeaponOnBack",player];};};if(count(weapons _0cv)>0)then{_0wv=((_0cv weaponDirection(weapons _0cv select 0))select 0)atan2((_0cv weaponDirection(weapons _0cv select 0))select 1);wgbeie=[_0cv,(getDir _0cv)-_0wv];if(local _0cv)then{["wgbeie",wgbeie]call wguu3i;}else{publicVariable "wgbeie";};};wgwa58=false;wgcybz=false;_0xv=player addAction[("<img image='i\r3f_release.paa'/> <t color=""#dddd00"">"+wg8r18+"</t>"),"r3f\R3F_LOG\objet_deplacable\relacher.sqf",nil,wgdv8x,true,true];_0yv=player addAction[("<img image='i\r3f_rotate.paa'/> <t color=""#dddd00"">Rotate the object</t>"),"r3f\R3F_LOG\objet_deplacable\rotate.sqf",nil,wgdv8x,true,true];_0zv=player addAction[("<img image='i\r3f_releaseh.paa'/> <t color=""#dddd00"">Release (horizontal)</t>"),"r3f\R3F_LOG\objet_deplacable\relacher2.sqf",nil,wgdv8x,true,true];while{!isNull wgcty8&&alive player}do{if(vehicle player!=player)then{systemChat wgo1mz;player action["eject",vehicle player];sleep 1;};if(([0,0,0]distance(velocity player)>4.9)&&!wgxspa)then{systemChat wgjwe1;_0fr="AmovPpneMstpSnonWnonDnon";if(currentWeapon player==handgunWeapon player)then{_0fr="amovpercmstpsraswpstdnon_amovppnemstpsraswpstdnon";};if(currentWeapon player==primaryWeapon player)then{_0fr="amovpercmstpsraswrfldnon_amovppnemstpsraswrfldnon"};player playMoveNow _0fr;sleep 2;};if(wgcty8 getVariable["object_locked",true])then{wgcty8 setVariable["object_locked",false,true];};sleep 0.25;};detach _0cv;wgsdmn=[_0cv,getPosWorld player select 2,wgcybz];if(local _0cv)then{wgsdmn call wgw4n2;}else{publicVariableServer "wgsdmn";};wgcybz=false;_0cv setVelocity[0,0,0];player reveal[_0cv,4];player forceWalk false;player removeAction _0xv;player removeAction _0yv;player removeAction _0zv;wgcty8=objNull;_0cv setVariable["R3F_LOG_est_deplace_par",objNull,true];};};};